!function e(t,n,i){function r(s,o){if(!n[s]){if(!t[s]){var c="function"==typeof require&&require;if(!o&&c)return c(s,!0);if(a)return a(s,!0);var l=new Error("Cannot find module '"+s+"'");throw l.code="MODULE_NOT_FOUND",l}var h=n[s]={exports:{}};t[s][0].call(h.exports,function(e){var n=t[s][1][e];return r(n?n:e)},h,h.exports,e,t,n,i)}return n[s].exports}for(var a="function"==typeof require&&require,s=0;s<i.length;s++)r(i[s]);return r}({1:[function(e,t,n){var i=e("./router");$(document).ready(function(){router=new i,Backbone.history.start({root:"/",pushState:!0}),console.log("Rewind started")})},{"./router":19}],2:[function(e,t,n){function i(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function r(e){return"function"==typeof e}function a(e){return"number"==typeof e}function s(e){return"object"==typeof e&&null!==e}function o(e){return void 0===e}t.exports=i,i.EventEmitter=i,i.prototype._events=void 0,i.prototype._maxListeners=void 0,i.defaultMaxListeners=10,i.prototype.setMaxListeners=function(e){if(!a(e)||0>e||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},i.prototype.emit=function(e){var t,n,i,a,c,l;if(this._events||(this._events={}),"error"===e&&(!this._events.error||s(this._events.error)&&!this._events.error.length)){if(t=arguments[1],t instanceof Error)throw t;throw TypeError('Uncaught, unspecified "error" event.')}if(n=this._events[e],o(n))return!1;if(r(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:for(i=arguments.length,a=new Array(i-1),c=1;i>c;c++)a[c-1]=arguments[c];n.apply(this,a)}else if(s(n)){for(i=arguments.length,a=new Array(i-1),c=1;i>c;c++)a[c-1]=arguments[c];for(l=n.slice(),i=l.length,c=0;i>c;c++)l[c].apply(this,a)}return!0},i.prototype.addListener=function(e,t){var n;if(!r(t))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,r(t.listener)?t.listener:t),this._events[e]?s(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,s(this._events[e])&&!this._events[e].warned){var n;n=o(this._maxListeners)?i.defaultMaxListeners:this._maxListeners,n&&n>0&&this._events[e].length>n&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace())}return this},i.prototype.on=i.prototype.addListener,i.prototype.once=function(e,t){function n(){this.removeListener(e,n),i||(i=!0,t.apply(this,arguments))}if(!r(t))throw TypeError("listener must be a function");var i=!1;return n.listener=t,this.on(e,n),this},i.prototype.removeListener=function(e,t){var n,i,a,o;if(!r(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(n=this._events[e],a=n.length,i=-1,n===t||r(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(s(n)){for(o=a;o-->0;)if(n[o]===t||n[o].listener&&n[o].listener===t){i=o;break}if(0>i)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(i,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},i.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[e],r(n))this.removeListener(e,n);else for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},i.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?r(this._events[e])?[this._events[e]]:this._events[e].slice():[]},i.listenerCount=function(e,t){var n;return n=e._events&&e._events[t]?r(e._events[t])?1:e._events[t].length:0}},{}],3:[function(e,t,n){t.exports.Dispatcher=e("./lib/Dispatcher")},{"./lib/Dispatcher":4}],4:[function(e,t,n){"use strict";function i(){this.$Dispatcher_callbacks={},this.$Dispatcher_isPending={},this.$Dispatcher_isHandled={},this.$Dispatcher_isDispatching=!1,this.$Dispatcher_pendingPayload=null}var r=e("./invariant"),a=1,s="ID_";i.prototype.register=function(e){var t=s+a++;return this.$Dispatcher_callbacks[t]=e,t},i.prototype.unregister=function(e){r(this.$Dispatcher_callbacks[e],"Dispatcher.unregister(...): `%s` does not map to a registered callback.",e),delete this.$Dispatcher_callbacks[e]},i.prototype.waitFor=function(e){r(this.$Dispatcher_isDispatching,"Dispatcher.waitFor(...): Must be invoked while dispatching.");for(var t=0;t<e.length;t++){var n=e[t];this.$Dispatcher_isPending[n]?r(this.$Dispatcher_isHandled[n],"Dispatcher.waitFor(...): Circular dependency detected while waiting for `%s`.",n):(r(this.$Dispatcher_callbacks[n],"Dispatcher.waitFor(...): `%s` does not map to a registered callback.",n),this.$Dispatcher_invokeCallback(n))}},i.prototype.dispatch=function(e){r(!this.$Dispatcher_isDispatching,"Dispatch.dispatch(...): Cannot dispatch in the middle of a dispatch."),this.$Dispatcher_startDispatching(e);try{for(var t in this.$Dispatcher_callbacks)this.$Dispatcher_isPending[t]||this.$Dispatcher_invokeCallback(t)}finally{this.$Dispatcher_stopDispatching()}},i.prototype.isDispatching=function(){return this.$Dispatcher_isDispatching},i.prototype.$Dispatcher_invokeCallback=function(e){this.$Dispatcher_isPending[e]=!0,this.$Dispatcher_callbacks[e](this.$Dispatcher_pendingPayload),this.$Dispatcher_isHandled[e]=!0},i.prototype.$Dispatcher_startDispatching=function(e){for(var t in this.$Dispatcher_callbacks)this.$Dispatcher_isPending[t]=!1,this.$Dispatcher_isHandled[t]=!1;this.$Dispatcher_pendingPayload=e,this.$Dispatcher_isDispatching=!0},i.prototype.$Dispatcher_stopDispatching=function(){this.$Dispatcher_pendingPayload=null,this.$Dispatcher_isDispatching=!1},t.exports=i},{"./invariant":5}],5:[function(e,t,n){"use strict";var i=function(e,t,n,i,r,a,s,o){if(!e){var c;if(void 0===t)c=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var l=[n,i,r,a,s,o],h=0;c=new Error("Invariant Violation: "+t.replace(/%s/g,function(){return l[h++]}))}throw c.framesToPop=1,c}};t.exports=i},{}],6:[function(e,t,n){"use strict";var i=function(e){var t,n={};if(!(e instanceof Object)||Array.isArray(e))throw new Error("keyMirror(...): Argument must be an object.");for(t in e)e.hasOwnProperty(t)&&(n[t]=t);return n};t.exports=i},{}],7:[function(e,t,n){"use strict";function i(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}t.exports=Object.assign||function(e,t){for(var n,r,a=i(e),s=1;s<arguments.length;s++){n=arguments[s],r=Object.keys(Object(n));for(var o=0;o<r.length;o++)a[r[o]]=n[r[o]]}return a}},{}],8:[function(e,t,n){var i=e("../appDispatcher"),r=e("../constants/update");t.exports=UpdateActions={create:function(e){i.dispatch({actionType:r.UPDATE_CREATE,text:e})},destroy:function(e){i.dispatch({actionType:r.UPDATE_DESTROY,id:e})},changeURL:function(e){i.dispatch({actionType:r.CHANGE_URL,url:e})},sync:function(){i.dispatch({actionType:r.SYNC})}}},{"../appDispatcher":9,"../constants/update":16}],9:[function(e,t,n){var i=e("flux").Dispatcher;t.exports=new i},{flux:3}],10:[function(e,t,n){var i=e("./yourUpdates.react");t.exports=AppComponent=React.createClass({displayName:"AppComponent",render:function(){return React.createElement(i,{url:"/api/updates"})}})},{"./yourUpdates.react":15}],11:[function(e,t,n){var i=e("../actions/update"),r=e("../utils/prettyDate"),a=3e4;t.exports=UpdateComponent=React.createClass({displayName:"UpdateComponent",_handleDelete:function(e){e.preventDefault(),i.destroy(this.props.id)},componentWillEnter:function(e){var t=$(this.getDOMNode());t.fadeIn(500,function(){e()})},componentWillLeave:function(e){var t=$(this.getDOMNode());t.fadeOut(500,function(){e()})},componentDidMount:function(){var e=this;this.renderTimer=setInterval(function(){e.forceUpdate.call(e)},a)},componentWillUnmount:function(){clearInterval(this.renderTimer)},render:function(){return React.createElement("li",{className:"update_box",style:{display:"none"}},React.createElement("div",{className:"update"},React.createElement("span",{className:"content"},this.props.children)),React.createElement("div",{className:"options"},React.createElement("button",{className:"delete",onClick:this._handleDelete},"Delete"),React.createElement("div",{className:"info"},React.createElement("span",{className:"timestamp"},r(new Date(this.props.timestamp)))," by ",React.createElement("span",{className:"username"},React.createElement("a",{href:"http://nathankunicki.com/rewind/"},"@nathankunicki")))))}})},{"../actions/update":8,"../utils/prettyDate":22}],12:[function(e,t,n){var i=e("../actions/update"),r=e("../constants/updateForm"),a=e("../components/updateFormLocationOption.react"),s={location:r.OPTION_LOCATION,image:r.OPTION_IMAGES,blog:r.OPTION_BLOG},o=React.addons.TransitionGroup;t.exports=UpdateFormComponent=React.createClass({displayName:"UpdateFormComponent",_viewState:{options:[]},_toggleUpdateOption:function(e){var t=this._viewState.options.indexOf(e);t>=0?this._viewState.options.splice(t,1):this._viewState.options.push(e),this.setState(this._viewState)},_isOptionSet:function(e){return this.state.options.indexOf(e)>=0?!0:!1},handleSubmit:function(e){e.preventDefault();var t=React.findDOMNode(this.refs.text).value.trim();t&&(i.create(t),React.findDOMNode(this.refs.text).value="")},handleOptionToggle:function(e){e.preventDefault(),this._toggleUpdateOption(s[e.target.className])},getInitialState:function(){return this._viewState},render:function(){var e=[];return this._isOptionSet(r.OPTION_LOCATION)&&e.push(React.createElement(a,null)),React.createElement("form",{className:"update_form",onSubmit:this.handleSubmit},React.createElement("textarea",{placeholder:"What's on your mind?",ref:"text"}),React.createElement(o,{className:"option_container"},e),React.createElement("div",{className:"options"},React.createElement("button",{className:"location",onClick:this.handleOptionToggle},"Add Location"),React.createElement("button",{className:"image",onClick:this.handleOptionToggle},"Add Image"),React.createElement("button",{className:"blog",onClick:this.handleOptionToggle},"Add Blog"),React.createElement("input",{type:"submit",value:"Post"})))}})},{"../actions/update":8,"../components/updateFormLocationOption.react":13,"../constants/updateForm":17}],13:[function(e,t,n){var i=e("../constants/updateForm"),r=e("../utils/getCurrentLocation"),a=function(e){var t=e.latitude,n=e.longitude,i={left:n-.1,top:t-.1,right:n+.1,bottom:t+.1},r="http://www.openstreetmap.org/export/embed.html?bbox=";return r+=i.left+",",r+=i.bottom+",",r+=i.right+",",r+=i.top,r+="&layer=mapnik&marker=",r+=t+",",r+=n};t.exports=UpdateFormLocationOptionComponent=React.createClass({displayName:"UpdateFormLocationOptionComponent",_viewState:{locationState:i.LOCATION_FETCHING,coords:null},_onLocationFound:function(e,t){e?(this._viewState.locationState=i.LOCATION_ERROR,this.setState(this._viewState)):(this._viewState.locationState=i.LOCATION_DISCOVERING,this._viewState.coords=t,this.setState(this._viewState))},componentWillMount:function(){this._viewState.locationState=i.LOCATION_FETCHING,r(this._onLocationFound)},componentWillEnter:function(e){var t=$(this.getDOMNode());t.slideDown(500,function(){e()})},componentWillLeave:function(e){var t=$(this.getDOMNode());t.slideUp(500,function(){e()})},getInitialState:function(){return this._viewState},render:function(){switch(this.state.locationState){case i.LOCATION_FETCHING:return React.createElement("div",{className:"location fetching",style:{display:"none"}},React.createElement("div",{className:"info"},"Fetching location..."));case i.LOCATION_DISCOVERING:return React.createElement("div",{className:"location discovering"},React.createElement("div",{className:"info"},"Discovering nearby places..."),React.createElement("iframe",{className:"map",src:a(this.state.coords)}));case i.LOCATION_FOUND:return React.createElement("div",{className:"location picker"},React.createElement("div",{className:"info"},"Success!"));default:return React.createElement("div",{className:"location error"},React.createElement("div",{className:"info"},"Error discovering location"))}}})},{"../constants/updateForm":17,"../utils/getCurrentLocation":21}],14:[function(e,t,n){var i=e("./update.react"),r=e("../actions/update"),a=e("../stores/updates"),s=function(e){for(var t=["id","timestamp","text"],n=0;n<t.length;n++)if(!e.get(t[n]))return!1;return!0},o=function(){return{updates:a.getAll()}},c=React.addons.TransitionGroup,l=null,h=1e4;t.exports=UpdatesListComponent=React.createClass({displayName:"UpdatesListComponent",_onChange:function(){this.setState(o())},componentDidMount:function(){a.addChangeListener(this._onChange),r.sync(),l=setInterval(function(){r.sync()},h)},componentWillUnmount:function(){a.removeChangeListener(this._onChange),clearInterval(l),l=null},getInitialState:function(){return r.changeURL(this.props.endpoint),o()},render:function(){for(var e=[],t=0;t<this.state.updates.length;t++){var n=this.state.updates.at(t);s(n)&&e.push(React.createElement(i,{key:n.get("id"),id:n.get("id"),timestamp:n.get("timestamp")},n.get("text")))}return React.createElement(c,{component:"ul",className:"updates_list"},e)}})},{"../actions/update":8,"../stores/updates":20,"./update.react":11}],15:[function(e,t,n){var i=e("../components/updateForm.react"),r=e("../components/updatesList.react"),a="/api/updates";t.exports=YourUpdatesComponent=React.createClass({displayName:"YourUpdatesComponent",render:function(){return React.createElement("div",{className:"my_updates"},React.createElement(i,null),React.createElement(r,{endpoint:a}))}})},{"../components/updateForm.react":12,"../components/updatesList.react":14}],16:[function(e,t,n){var i=e("keymirror");t.exports=i({UPDATE_CREATE:null,UPDATE_DESTROY:null,CHANGE_URL:null,SYNC:null})},{keymirror:6}],17:[function(e,t,n){var i=e("keymirror");t.exports=i({OPTION_LOCATION:null,OPTION_IMAGES:null,OPTION_BLOG:null,VISIBILITY_PUBLIC:null,VISIBILITY_FRIENDS:null,VISIBILITY_PRIVATE:null,LOCATION_FETCHING:null,LOCATION_DISCOVERING:null,LOCATION_FOUND:null,LOCATION_ERROR:null})},{keymirror:6}],18:[function(e,t,n){t.exports=UpdateModel=Backbone.Model.extend({defaults:{timestamp:null,text:null},urlRoot:"/api/updates"})},{}],19:[function(e,t,n){var i=e("./components/app.react");t.exports=Router=Backbone.Router.extend({routes:{"*filter":"setFilter"},setFilter:function(e){React.render(React.createElement(i,null),$("#app").get(0))}})},{"./components/app.react":10}],20:[function(e,t,n){var i=e("events").EventEmitter,r=e("object-assign"),a=e("../appDispatcher"),s=e("../constants/update"),o=e("../models/update"),c="change",l=Backbone.Collection.extend({model:o,comparator:function(e,t){return new Date(t.get("timestamp"))-new Date(e.get("timestamp"))},initialize:function(e){e=e||{},this.url=e.url||"/api/updates"}}),h=new l,u=r({},i.prototype,{getAll:function(){return h},emitChange:function(){this.emit(c)},addChangeListener:function(e){this.on(c,e)},removeChangeListener:function(e){this.removeListener(c,e)}});h.on("add change remove",u.emitChange.bind(u),u);var p=function(e){var t=new o({timestamp:(new Date).toISOString(),text:e});h.add(t),t.save()},d=function(e){var t=h.get(e);t.destroy()},m=function(e){h.set([]),h.url=e},f=function(){h.fetch()};t.exports=u,a.register(function(e){switch(e.actionType){case s.UPDATE_CREATE:p(e.text),u.emitChange();break;case s.UPDATE_DESTROY:d(e.id),u.emitChange();break;case s.CHANGE_URL:m(e.url);break;case s.SYNC:f()}})},{"../appDispatcher":9,"../constants/update":16,"../models/update":18,events:2,"object-assign":7}],21:[function(e,t,n){t.exports=getCurrentLocation=function(e){return navigator.geolocation?navigator.geolocation.getCurrentPosition(function(t){e(null,{latitude:t.coords.latitude,longitude:t.coords.longitude})}):e(!0),!1}},{}],22:[function(e,t,n){var i=function(e,t,n){return function(i){var r=Math.floor(i/e),a=t+(r>1?"s":"");return""+r+" "+a+" "+n}},r=[{threshold:-31535999,handler:i(-31536e3,"year","from now")},{threshold:-2591999,handler:i(-2592e3,"month","from now")},{threshold:-604799,handler:i(-604800,"week","from now")},{threshold:-172799,handler:i(-86400,"day","from now")},{threshold:-86399,handler:function(){return"tomorrow"}},{threshold:-3599,handler:i(-3600,"hour","from now")},{threshold:-59,handler:i(-60,"minute","from now")},{threshold:-.9999,handler:i(-1,"second","from now")},{threshold:5,handler:function(){return"Just now"}},{threshold:60,handler:i(1,"second","ago")},{threshold:3600,handler:i(60,"minute","ago")},{threshold:86400,handler:i(3600,"hour","ago")},{threshold:172800,handler:function(){return"Yesterday"}},{threshold:604800,handler:i(86400,"day","ago")},{threshold:2592e3,handler:i(604800,"week","ago")},{threshold:31536e3,handler:i(2592e3,"month","ago")},{threshold:1/0,handler:i(31536e3,"year","ago")}];t.exports=prettyDate=function(e){for(var t=((new Date).getTime()-e.getTime())/1e3,n=0;n<r.length;n++)if(t<r[n].threshold)return r[n].handler(t);return"Unknown date"}},{}]},{},[1]);